# 需求规格说明书
---

 1. 引言 
  1. 编写目的 
  2. 背景 
  3. 定义 
  4. 参考资料 
 2. 任务概述 
  1. 目标 
  2. 用户的特点 
  3. 假定和约束 
 3. 需求规定 
  1. 对功能的规定 
  2. 对性能的规定 
   - 精度 
   - 时间特性要求 
   - 灵活性 
  3. 输人输出要求 
   - 数据管理能力要求 
   - 故障处理要求 
   - 其他专门要求 
 4. 运行环境规定 
  1. 设备 
  2. 支持软件 
  3. 接口 
  4. 控制 
 
 
## 1. 引言
### 1.1 编写目的
本文档的目的在于更好地理解题目中的功能性和非功能性要求，使项目在开发过程中的方向更加明确化、规范化、系统化，用此文档驱动大数据分析平台开发，建立WiFi探针商业大数据分析平台。
### 1.2 背景
说明： 

  - 随着时代的发展，每人一部手机基本是一个趋势，所以可以通过对手机MAC地址的分析来进行对客流量的分析。
  - 利用探针数据的客流分析打破模式束缚，不仅仅只是提供可信的客流数据分析，同时还利用延伸的标杆管理才能，深刻洞悉并提供有助于推动实际客流量和消费者习惯行为的一系列因素。这种专业才能呈现了经济分析，社交和环境等一些超出你控制范围的因素，却对商业绩效产生主要的冲击力。 
  - 首先开发探针设备能够采集客户唯一的定位标识，比如MAC地址，通过数据分析技术，采用离线计算和实时计算结合的方式，为商业环境提供科学的、全面的数据决策依据。不仅对营销能力的评估，也可以对管理上进行优化。 
  - 本系统的任务提出者：“中国软件杯”大学生软件设计大赛官方。 
  - 该系统申请了云平台和使用的云服务计算框架。

### 1.3 定义 
 - MAC：手机的唯一标识符。
 - WIFI探针技术：当一个设备给另外一个设备通过无线传输技术发送信息时，周围的其他同类设备都是能够收到这些信息的。
 - 客流量：店铺或区域整体客流及趋势。
 - 入店量：进入店铺或区域的客流及趋势
 - 入店率：进入店铺或区域的客流占全部客流的比例及趋势
 - 来访周期：进入店铺或区域的顾客距离上次来店的间隔
 - 新老顾客：一定时间段内首次/两次以上进入店铺的顾客
 - 顾客活跃度：按顾客距离上次来访间隔,划分为不同活跃度
 - 驻店时长：进入店铺的顾客在店内的停留时长
 - 跳出率：进入店铺后很快离店的顾客及占比(占总体客流)
 - 深访率：进入店铺深度访问的顾客及占⽐(占总体客流) 
 
### 1.4 参考资料
 - a. 刘军等著，Spark大数据处理原理、算法与实例，清华大学出版社，2016年  
 - Lars George著，HBase权威指南，人民邮电出版社，2013年 
 - 谭磊等编，Hadoop应用实践，清华大学出版社，2017年 
 - Bruce Eckel著，Scala编程思想，机械工业出版社，2016年 
 - 夏辉等编，项目软件管理，清华大学出版社，2015年。

## 2. 任务概述
### 2.1 目标

如今，大数据已经成为了一种财富，大到国家，小到中小企业都在利用大数据技术辅助决策，对于商场客流分析，因打破传统可信数据流模式，应用大数据技术不仅可以和传统分析数据相辅相成，而且可以实时的对客流情况进行监控，便于及时做出决策。WIFI探针设备能够采集客户唯一的定位标识，比如MAC地址，通过数据分析技术，采用离线计算和实时计算结合的方式，为商业环境提供科学的、全面的数据决策依据。不仅对营销能力的评估，也可以对管理上进行优化。 

该系统将基于WIFI探针的商业大数据分析技术，通过WIFI探针收集MAC地址、出现时间、出现地点、与探针距离，探针设备会定时(60s)发送数据到服务端，通过一段时间数据平台产生大量的用户数据，把数据存储到数据库当中，然后使用大数据分析技术，采用离线计算和实时计算技术相结合的方式，主要是实现三个方面的功能：一是通过探针设备采集可监测范围内的手机MAC地址、地理位置、与探针距离、时间等信息；二是探针采集的数据可以定时发送到服务端保存；三是利用大数据技术对数据进行人流量等指标的分析(从小时、日、周、月多维度分析)。本系统能够对商业环境中门店的门前人流量、进店客流量、进入跳出量、新老顾客数量及新增量、顾客活跃度，跳出率，深访率，在店平均时长进行分析，客流情况更新迅速，便于实时查看线下人群密集程度，有利于总部统一管理并及时调整营销活动方案。新老顾客比例，来访周期，顾客活跃度清晰展示，便于及时掌握入场顾客的构成，为销售策略调整提供参考。通过驻店时长可以快速掌握店招、产品或营销活动的吸引力。 

### 2.2 用户的特点 

该系统平台分两部分进行维护、管理和使用，分别为服务器端的维护、管理和客户端用户对平台的使用以及根据统计数据制定相应的决策。故该平台的用户也分为两部分：进行服务器端维护、管理的用户需要具有分布式环境的运维能力，熟悉Hadoop、Spark、HBase等开源框架，能够应对日常平台运行日志的分析工作；使用大数据分析结果展示平台的用户则需要具备一定的数据转换能力和决策制定能力，能根据统计数据为特定商业环境提出更加有效的策略、方案。 
 
本系统的前期配置和安装由本公司进行，配置完成后本系统的操作由店铺门面的相关员工完成，系统操作简单明了。只需操作者明白客流量、入店量、入店率、来访周期、新老顾客、顾客活跃度、驻店时长、跳出率、深访率等含义和使用即可。
 
### 2.3 假定和约束
本系统平台为参赛作品，开发者均为学生，故存在诸多限制： 

 - 设备限制： 初步开发时，基于个人笔记本电脑进行开发及环境搭建，但个人笔记本不能全部用于系统平台的搭建和运行，而且在集群搭建方面也存在诸如网络等诸多问题，后期虽然会转移到云服务器，但介于内存和带宽限制，可能仍然无法展现真实商业环境。
 - 经费限制：比赛中所要购买的探针、云服务器均需自费，故而不会购买性能更好的云服务器。
 - 环境限制：学生机房并不是可以一直驻守的地方，且平时课程较多，故在数据采集方面也存在限制；
 - 开发期限：2017-03-15 至2017-06-15
 - 技术限制：单机性能限制。

## 3. 需求规定 
3.1对功能的规定

| 输入             | 处理          |  输出  |
| -----------------|:-------------:| :-----:|
| 探针接收的数据   | 服务器端接受POST请求,并写入HDFS | 后台不断读取HDFS中的文件,进行分析操作 |
| HDFS中的文件数据 | 将JSON处理分离出来, 将数据库入库分离出来      |   JSON主体数据 |
 
 

### 3.2 对性能的规定
#### 3.2.1 精度 
 
探针发送数据精度：对于探针范围类的顾客，12s内要求至少有一次包含该用户的mac记录。 
 
分析数据的精度：对于每一天的数据分析（比如客流量）精确到小时，对于每一月的分析精确到日，每一年的数据精确到月；
 
误差：本系统采用了相关处理误差的方法，每天的客流量和进店量统计总数不会超过20；
 
#### 3.2.2 时间特性要求
 - 响应时间：每个功能的响应时间不超过5s；
 - 时间自定义：每个用户可以自行设置进行数据分析（采用分布式对探针接收的原始数据进行分析）的时间（探针关闭时或客流很少的时候），；
 - 更新处理时间：探针探测的数据每隔3s发送一次，更新一次；
 - 该系统可以允许用户访问任何时刻的数据和分析效果，和未来7天数据的预测。
### 3.2.3 灵活性
 - 操作方式简单，用户可以简单操作就可以在前端看到进行实时显示的数据信息。
 - 运行环境的变化：主要用到电脑主机和云服务器终端。
 - 每款探针的误差和相关参数的规定可能不同，本系统支持相关参数的设置，来灵活解决探针的误差和商家选取不同探针带来的问题； 
 - 本系统即可看到某一天的具体数据也可看到某一月，某一年的数据。
 
### 3.3 输入输出要求
系统输入: 
 1.	从图形用户界面输入查询信息
 2.	从命令行界面输入查询信息
 3.	从配置文件读取配置信息
系统输出：
 1.	从图形用户界面输出
 2.	命令行界面输出
 
### 3.4 数据管理能力要求
采用了分表概念每天会根据用户设定的时间（选取客流少或探针关闭的时间）进行分表操作： 

 - 操作1：每天创建一个客流量表（客流量数据相对较大），客流表字段有 mac地址，进店时间，出店时间，停留时间 对今天的原始数据分析提取出客流信息并存入相关客流表中；
 - 操作2：对今天的原始数据分析提取出顾客（进店的顾客）信息并存入相关顾客表和顾客详细表；
 - 操作3：每天创建一个存原始数据的表，将接收探针发送原始数据的表的数据转移到这张表中（避免接收探针发送原始数据的表的数据过多）；
以上操作加上了分布式处理的技术加快程序允许效率


### 3.5 故障处理要求
对于硬件来说，误差无法避免，就我们项目而言，
 
 - 误差1：深处探针范围类的顾客，探针有可能探测不到，对我们判断顾客出店造成影响
解决方案：定义一张参数表，增加字段out_time   int属性单位秒，当探针在out_time
时间内一次都没探测到顾客的mac地址，则判断上一次探测到的时间即为出店时间
 - 误差2：本系统根据用户设置的信号强度（参数表与相关字段）作为进店条件，但是探针的不稳定性会带来误差
解决方案：当其信号强度连续3次达到进店条件即判断为第一次探测到时为进店时间。


### 3.6 非功能性要求
本系统要求安全保密性强，操作简单，能够实时展示后台数据。可用性讲：结合用例和界面场景，依据用户特征，确定可用性标准，系统本身需要的：界面风格，界面层次，导航策略 ，关联策略，提示信息策略。要求后期可长期维护，运行可靠，配置简单。
 
## 4. 运行环境规定
### 4.1 设备
WIFI探针：见附件：DataSkyWifi探针产品说明书
电脑主机，云服务器
### 4.2 支持软件
采用Python语言编程，支持Linux系统等，需求环境：Ubuntu 16.04，Docker 1.12.6，Docker镜像 Ubuntu 14.04，Hadoop 2.7.3，Hbase 1.2.5，Spark 1.6.0，Apache 2.4.7，Mysql 14.14
### 4.3 控制
探针： 见附件：DataSkyWifi探针产品说明书
软件模块：提供后台管理界面




